
  <!DOCTYPE html>
  <html>
    <head>
      <title>server.js</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">server/server.js</td><td class="">85.71%</td><td class="">80%</td><td class="">175</td><td class="">150</td><td class="">25</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">const {
  getElapsedTime,
  clearElapsedTime,
  graphqlSchema,
} = require(&quot;./schema/schema.js&quot;);
const express = require(&quot;express&quot;);
const app = express();
const cors = require(&quot;cors&quot;);
const bodyparser = require(&quot;body-parser&quot;);
const mongoose = require(&quot;mongoose&quot;);
const { QuellCache } = require(&quot;../quell-server/src/quell.js&quot;);
const env = require(&quot;dotenv&quot;).config();
const schema = graphqlSchema;
const quellCache = new QuellCache({
  schema: schema,
  cacheExpiration: 3600,
  redisPort: process.env.REDIS_PORT,
  redisHost: process.env.REDIS_HOST,
  redisPassword: process.env.REDIS_PASSWORD,
});

app.use(express.json());
app.use(express.urlencoded({ extended: true }));
app.use(bodyparser.json());
app.use(cors());

mongoose
  .connect(process.env.MONGO_URI, {
    useNewUrlParser: true,
    useUnifiedTopology: true,
  })
  .then(() =&gt; console.log(&quot;Connected to MongoDB&quot;))
  .catch((err) =&gt; console.log(err));

const PORT = process.env.PORT || 3000;

app.use(express.static(&quot;./dist&quot;));

// clearElapsedTime so that elapsedTime doesn&#x27;t persist old times for new queries
app.use(
  &quot;/api/graphql&quot;,
  clearElapsedTime,
  quellCache.rateLimiter,
  quellCache.costLimit,
  quellCache.depthLimit,
  quellCache.query,
  (req, res) =&gt; {
    console.log(&quot;inside server route to /api/graphql&quot;);
    console.log(&#x27;res.locals in server: &#x27;, res.locals);
    return res.status(200).send(res.locals);
  }
);

app.get(&quot;/api/clearCache&quot;, quellCache.clearCache, (req, res) =&gt; {
  return res.status(200).send(&quot;Redis cache successfully cleared&quot;);
});

app.use(
  &quot;/api/redis&quot;,
  quellCache.getRedisInfo({
    getStats: true,
    getKeys: true,
    getValues: true,
  }),
  (req, res) =&gt; {
    return res.status(200).send(res.locals);
  }
);

app.use(&quot;/api/queryTime&quot;, getElapsedTime, (req, res) =&gt; {
  // console.log(&#x27;elapsed time&#x27;, getElapsedTime);
  // console.log(&#x27;elapsed time&#x27;, res.locals.time);
  return res.status(200).send(res.locals);
  // console.log(&#x27;reached /api/queryTime&#x27;);
});

app.use((req, res) =&gt;
  res.status(404).send(&quot;This is not the page you&#x27;re looking for...&quot;)
);

app.use((err, req, res, next) =&gt; {
  const defaultErr = {
    log: &quot;Express error handler caught unknown middleware error&quot;,
    status: 500,
    message: { err: &quot;An error occurred&quot; },
  };
  const errorObj = Object.assign({}, defaultErr, err);
  console.log(errorObj.log);
  return res.status(errorObj.status).json(errorObj.message.err);
});

app.listen(PORT, () =&gt; {
  console.log(`Server listening on port: ${PORT}...`);
});
</textarea><pre id="annotations" style="display:none">[{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:32,&quot;character&quot;:10,&quot;text&quot;:&quot;err&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:32,&quot;character&quot;:30,&quot;text&quot;:&quot;err&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:64,&quot;character&quot;:3,&quot;text&quot;:&quot;req&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:64,&quot;character&quot;:8,&quot;text&quot;:&quot;res&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:65,&quot;character&quot;:11,&quot;text&quot;:&quot;res&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:65,&quot;character&quot;:15,&quot;text&quot;:&quot;status&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:65,&quot;character&quot;:27,&quot;text&quot;:&quot;send&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:65,&quot;character&quot;:32,&quot;text&quot;:&quot;res&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:65,&quot;character&quot;:36,&quot;text&quot;:&quot;locals&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:80,&quot;character&quot;:9,&quot;text&quot;:&quot;err&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:80,&quot;character&quot;:14,&quot;text&quot;:&quot;req&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:80,&quot;character&quot;:19,&quot;text&quot;:&quot;res&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:80,&quot;character&quot;:24,&quot;text&quot;:&quot;next&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:86,&quot;character&quot;:8,&quot;text&quot;:&quot;errorObj&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:86,&quot;character&quot;:49,&quot;text&quot;:&quot;err&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:87,&quot;character&quot;:14,&quot;text&quot;:&quot;errorObj&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:87,&quot;character&quot;:23,&quot;text&quot;:&quot;log&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:88,&quot;character&quot;:9,&quot;text&quot;:&quot;res&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:88,&quot;character&quot;:13,&quot;text&quot;:&quot;status&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:88,&quot;character&quot;:20,&quot;text&quot;:&quot;errorObj&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:88,&quot;character&quot;:29,&quot;text&quot;:&quot;status&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:88,&quot;character&quot;:37,&quot;text&quot;:&quot;json&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:88,&quot;character&quot;:42,&quot;text&quot;:&quot;errorObj&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:88,&quot;character&quot;:51,&quot;text&quot;:&quot;message&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;server/server.js&quot;,&quot;line&quot;:88,&quot;character&quot;:59,&quot;text&quot;:&quot;err&quot;,&quot;kind&quot;:1}]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Thu, 22 Jun 2023 00:10:40 GMT</p>
    </body>
  </html>
  